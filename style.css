:root{
  --bg:#f5f7fb;
  --card:#ffffff;
  --text:#0b1324;
  --muted:#6b7a90;
  --outline:#d7dfeb;

  --blue:#0b66ff;
  --red:#ff3b57;
  --c1:#8b6ad8; /* 1S */
  --c2:#ff5a5f; /* 2S */
  --c3:#f2b731; /* 3S */
  --c4:#2dbE6d; /* 4S */
  --c5:#2f7ef6; /* 5S */
}

:root.dark{
  --bg:#0b1220;
  --card:#101a2e;
  --text:#e7eefc;
  --muted:#a7b6cf;
  --outline:#23324f;

  --blue:#3b82f6;
  --red:#ff5c74;
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;font:16px/1.45 system-ui,Segoe UI,Roboto,Arial;
  color:var(--text);background:var(--bg);
}

.topbar{
  position:sticky;top:0;z-index:10;
  display:flex;justify-content:space-between;gap:12px;
  align-items:center;padding:10px 14px;background:var(--card);
  border-bottom:1px solid var(--outline);
}
.brand{display:flex;align-items:center;gap:10px}
.brand img{width:28px;height:28px;border-radius:6px}
.brand span{font-weight:700}
.brand small{margin-left:6px;color:var(--muted)}

.tools{display:flex;gap:.5rem;flex-wrap:wrap}
.btn{
  padding:8px 12px;border:1px solid var(--outline);background:var(--card);
  border-radius:10px;color:var(--text);cursor:pointer
}
.btn:hover{filter:brightness(1.04)}
.btn.primary{background:var(--blue);color:#fff;border-color:transparent}
.btn.ghost{background:transparent}
.btn.danger{background:var(--red);border-color:transparent;color:#fff}
.btn.file{position:relative}

.container{max-width:1200px;margin:20px auto;padding:0 12px}

.card{
  background:var(--card);border:1px solid var(--outline);
  border-radius:16px;padding:16px;margin-bottom:16px
}

/* Intro */
.intro{display:grid;grid-template-columns:220px 1fr;gap:16px}
.intro .hero{width:100%;height:auto;border-radius:12px}
.intro h2{margin:.2rem 0 .4rem}
.bullets{margin:0;padding-left:18px}
.bullets li{margin:.25rem 0}

.pill{display:inline-flex;align-items:center;gap:6px;padding:2px 10px;border-radius:999px;border:2px solid currentColor;font-weight:700}
.pill.s1{color:var(--c1)}.pill.s2{color:var(--c2)}.pill.s3{color:var(--c3)}.pill.s4{color:var(--c4)}.pill.s5{color:var(--c5)}

/* Filtri */
.filters .row{display:grid;grid-template-columns:1fr 220px auto auto auto;gap:10px}
.filters input, .filters select{
  width:100%;padding:10px;border:1px solid var(--outline);border-radius:10px;background:var(--card);color:var(--text)
}
.seg{display:flex;gap:6px;align-items:center}
.seg-btn{padding:8px 12px;border:1px solid var(--outline);background:var(--card);border-radius:999px;cursor:pointer}
.seg-btn.active{background:var(--blue);color:#fff;border-color:transparent}
.chk{display:flex;gap:8px;align-items:center;color:var(--muted)}
.chk input{width:18px;height:18px}
.chk.stack{margin-left:8px}

/* Dashboard */
.kpis{display:grid;grid-template-columns:repeat(3, 1fr) auto;gap:12px;align-items:center;margin-bottom:10px}
.kpi{background:var(--card);border:1px solid var(--outline);border-radius:12px;padding:12px}
.kpi-title{color:var(--muted);font-size:.85rem}
.kpi-value{font-weight:800;font-size:1.2rem}

.zoom{display:flex;align-items:center;gap:6px;margin-left:auto}
.mini{width:28px;height:28px;border-radius:8px;border:1px solid var(--outline);background:var(--card);cursor:pointer}

.chart-wrap{display:flex;flex-direction:column;gap:10px}
.chart-scroll{overflow-x:auto;border:1px dashed var(--outline);border-radius:12px}
.chart-inner{min-height:260px}
.lines{display:flex;flex-wrap:wrap;gap:8px;margin-top:8px}
.line-btn{padding:6px 10px;border:1px solid var(--outline);background:var(--card);border-radius:999px;cursor:pointer}
.line-btn.active{background:var(--blue);color:#fff;border-color:transparent}

.legend{display:flex;gap:8px}
.chip{padding:4px 10px;border-radius:999px;background:var(--outline);font-weight:700}
.chip.s1{background:color-mix(in srgb, var(--c1) 18%, #fff)} .chip.s2{background:color-mix(in srgb, var(--c2) 18%, #fff)}
.chip.s3{background:color-mix(in srgb, var(--c3) 22%, #fff)} .chip.s4{background:color-mix(in srgb, var(--c4) 18%, #fff)}
.chip.s5{background:color-mix(in srgb, var(--c5) 18%, #fff)}

.late-list{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
.late-chip{border:1px solid var(--outline);background:var(--card);border-radius:999px;padding:6px 10px;cursor:pointer}
.late-chip:hover{background:var(--outline)}
.late-chip .meta{color:var(--muted);margin-right:6px}

.fold-all{display:flex;gap:8px;margin-top:6px}

/* Area */
.area-hd{display:grid;grid-template-columns:220px 1fr auto auto;gap:10px;align-items:center}
.area-line{height:40px;border:1px solid var(--outline);border-radius:10px;padding:0 10px;background:var(--card);color:var(--text)}
.score{display:flex;gap:6px;flex-wrap:wrap}
.score-pill{display:inline-flex;align-items:center;gap:6px;border-radius:999px;border:2px solid transparent;padding:6px 10px;font-weight:800;cursor:pointer;user-select:none}
.score-pill.s1{border-color:var(--c1)} .score-pill.s2{border-color:var(--c2)}
.score-pill.s3{border-color:var(--c3)} .score-pill.s4{border-color:var(--c4)} .score-pill.s5{border-color:var(--c5)}
.score-pill.active{background:color-mix(in srgb, var(--blue) 16%, transparent)}
.sum{display:flex;gap:10px;align-items:center}
.badge{background:var(--outline);padding:6px 10px;border-radius:999px}
.hd-actions{display:flex;gap:8px;justify-self:end}

.tabs{margin-top:8px}
.tab{padding:8px 12px;border:1px solid var(--outline);border-radius:999px;background:var(--card);cursor:pointer;margin-right:6px}
.tab.active{background:var(--blue);color:#fff;border-color:transparent}

.panels{margin-top:6px;display:grid;gap:16px}
.panel h4{margin:.2rem 0}
.s-desc{margin:.25rem 0 .75rem;color:var(--muted)}

.items{display:grid;gap:10px}
.item{border:1px solid var(--outline);border-radius:12px;background:var(--card);padding:10px}
.item.late{outline:2px dashed #f39}
.item-hd{display:grid;grid-template-columns:40px 1fr auto;gap:8px;align-items:center}
.item .info{width:32px;height:32px;border-radius:999px;border:1px solid var(--outline);background:var(--card);cursor:pointer}
.item .txt{height:36px;border:1px solid var(--outline);border-radius:10px;padding:0 10px;background:var(--card);color:var(--text)}
.points-dots .dot{width:34px;height:34px;border-radius:999px;border:1px solid var(--outline);background:var(--card);cursor:pointer;margin-left:4px}
.points-dots .dot.active{background:var(--blue);color:#fff;border-color:transparent}

.item-row{display:grid;grid-template-columns:1fr 170px 1fr;gap:8px;margin-top:8px}
.item-row input{height:36px;border:1px solid var(--outline);border-radius:10px;padding:0 10px;background:var(--card);color:var(--text)}
.item-actions{margin-top:8px}
.item-actions .del{width:100%;max-width:260px}

.item-desc{display:none;margin:6px 0 12px;padding:10px;border-left:4px solid var(--outline);color:var(--muted)}
.item.highlight{box-shadow:0 0 0 3px #ffb40066 inset;border-color:#ffb400}
.item.flash{animation:flash .8s ease 1}
@keyframes flash{0%{background:#ffe9b3}100%{background:transparent}}

.area.collapsed .panels{display:none}

/* Responsive */
@media (max-width:900px){
  .intro{grid-template-columns:1fr}
  .area-hd{grid-template-columns:1fr}
  .filters .row{grid-template-columns:1fr}
  .item-row{grid-template-columns:1fr}
}


/* Footer version small */
.app-footer{display:flex;justify-content:flex-end;align-items:center;padding:10px 14px}
.app-footer small{opacity:.72;font-size:11px}

/* Line title badge */
.area .line-title,
.area input[type="text"].line-title {
  background:linear-gradient(180deg,#ffffff,#f5f7fb);
  border:1px solid var(--outline);
  border-radius:12px;
  padding:8px 12px;
  font-weight:700;
  letter-spacing:.2px;
}
:root[data-theme="dark"] .area .line-title,
:root[data-theme="dark"] .area input[type="text"].line-title {
  background:linear-gradient(180deg,#0e1630,#0b1226);
  color:var(--text);
  border-color:#2b3b7c;
}

/* Colored S tags */
.s-tag{display:inline-flex;align-items:center;justify-content:center;min-width:36px;height:26px;border-radius:999px;padding:0 10px;font-weight:800;letter-spacing:.3px;color:#fff}
.s-tag.s1{background:#7c5cff}
.s-tag.s2{background:#ff8737}
.s-tag.s3{background:#2ba6ff}
.s-tag.s4{background:#28c48d}
.s-tag.s5{background:#7a5cff}

/* 3D-style score dots */
.points-dots{display:flex;gap:8px;flex-wrap:wrap}
.points-dots .dot{
  width:36px;height:36px;border-radius:50%;
  background: radial-gradient(120% 120% at 30% 30%, rgba(255,255,255,.85), rgba(255,255,255,.1) 40%, rgba(0,0,0,.12) 100%);
  border:1px solid rgba(0,0,0,.08);
  box-shadow: inset 0 2px 6px rgba(255,255,255,.25), inset 0 -6px 10px rgba(0,0,0,.18), 0 6px 12px rgba(0,0,0,.08);
  display:grid;place-items:center;font-weight:800;
}
.points-dots .dot.active{outline:2px solid var(--blue)}
.points-dots .dot[data-val="0"]{background:#f1f3f5}
.points-dots .dot[data-val="1"]{background:linear-gradient(#ffe8ef,#ffccd5)}
.points-dots .dot[data-val="2"]{background:linear-gradient(#fff2e1,#ffd8a8)}
.points-dots .dot[data-val="3"]{background:linear-gradient(#e6f4ff,#d0ebff)}
.points-dots .dot[data-val="4"]{background:linear-gradient(#e9fbf4,#c3fae8)}
.points-dots .dot[data-val="5"]{background:linear-gradient(#e8ffe8,#b2f2bb)}

/* Card readability & chips */
.area{background:var(--panel); border:1px solid var(--outline); box-shadow: 0 6px 20px rgba(0,0,0,.06);}
.chips .chip{font-weight:700}
.chips .chip strong{font-weight:800}

/* Dark theme: improve contrast */
:root[data-theme="dark"]{
  --text:#eaf1ff;
  --muted:#b8c4e6;
  --panel:#0e1426;
  --outline:#2b3a7a;
}
:root[data-theme="dark"] .chip{background:#121b36;color:#dbe7ff;border-color:#2a3a7a}
:root[data-theme="dark"] .menu, :root[data-theme="dark"] .dropdown{background:#0f162d;color:var(--text)}
