:root{
  --bg:#f6f8fc;
  --card:#ffffff;
  --text:#0b1324;
  --muted:#667085;
  --outline:#e1e6ef;
  --brand:#0b5bd7;

  --c1:#7b61ff; /* 1S */
  --c2:#e2574c; /* 2S */
  --c3:#f2a933; /* 3S */
  --c4:#2fb368; /* 4S */
  --c5:#2e7be6; /* 5S */

  --danger:#e54b4b;
  --shadow:0 6px 16px rgba(20,35,70,.08);
}

:root.dark{
  --bg:#0e1422;
  --card:#141c2d;
  --text:#edf2ff;
  --muted:#9fb1d3;
  --outline:#25314a;
  --brand:#4e91ff;
  --shadow:none;
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,'Helvetica Neue',Arial;
  background:var(--bg); color:var(--text);
}

/* App bar */
.appbar{
  position:sticky; top:0; z-index:10;
  display:flex; justify-content:space-between; align-items:center;
  padding:10px 14px; background:var(--card); border-bottom:1px solid var(--outline);
}
.appbar .brand{display:flex; align-items:center; gap:10px; font-weight:700}
.appbar .brand small{opacity:.6}
.appbar .tools{display:flex; gap:8px; align-items:center}

/* Generic */
.card{
  background:var(--card); border:1px solid var(--outline); border-radius:14px;
  padding:14px; margin:14px; box-shadow:var(--shadow);
}
.btn{border:1px solid var(--outline); background:var(--card); color:var(--text); padding:8px 12px; border-radius:10px; cursor:pointer}
.btn.primary{background:var(--brand); color:#fff; border-color:transparent}
.btn.icon{width:38px; height:38px; display:inline-grid; place-items:center}
.btn.danger{background:var(--danger); color:#fff; border-color:transparent}
.btn:active{transform:translateY(1px)}
.select{padding:8px 12px; border:1px solid var(--outline); border-radius:10px; background:var(--card); color:var(--text)}
.chk{display:flex; align-items:center; gap:8px}
.row{display:flex; gap:10px; flex-wrap:wrap}
.spread{justify-content:space-between}

/* Intro */
.intro{display:flex; gap:16px; align-items:center}
.intro .hero{width:180px; height:auto; border-radius:12px}
.intro-text{flex:1}
.s-legend{padding-left:16px}
.s-legend li{margin:6px 0}

/* filtri */
.filters .field{position:relative}
.filters .field .icon{position:absolute; left:10px; top:50%; transform:translateY(-50%); opacity:.5}
.filters .field input{padding:10px 12px 10px 34px; min-width:280px; border:1px solid var(--outline); border-radius:10px; background:var(--card); color:var(--text)}
.seg{display:flex; gap:8px; align-items:center}
.seg-btn{border:1px solid var(--outline); background:var(--card); padding:8px 12px; border-radius:20px; cursor:pointer}
.seg-btn.active{background:var(--brand); color:#fff; border-color:transparent}
.hide-on-wide{display:none}
@media (max-width: 860px){ .hide-on-wide{display:inline-block} }

/* chip colori */
.chip{display:inline-flex; align-items:center; gap:8px; padding:4px 10px; border-radius:999px; border:2px solid transparent; font-weight:700}
.chip-1s{border-color:var(--c1); color:var(--c1)}
.chip-2s{border-color:var(--c2); color:var(--c2)}
.chip-3s{border-color:var(--c3); color:var(--c3)}
.chip-4s{border-color:var(--c4); color:var(--c4)}
.chip-5s{border-color:var(--c5); color:var(--c5)}

.badge{display:inline-flex; gap:6px; align-items:center; padding:6px 10px; border-radius:999px; font-weight:700}
.badge.blue{background:var(--brand); color:#fff}
.badge.outline{border:2px solid var(--outline); color:var(--text); background:transparent}

/* KPI */
.kpi-row{display:flex; align-items:center; gap:12px; flex-wrap:wrap}
.kpi{min-width:160px; flex:0 0 auto; background:var(--card); border:1px solid var(--outline); border-radius:12px; padding:10px 12px}
.kpi-title{font-size:.9rem; color:var(--muted)}
.kpi-val{font-weight:800; font-size:1.4rem}

/* Chart */
.chart-toolbar{margin-left:auto}
.chart-wrap{margin-top:10px}
.chart-scroll{overflow:auto; border:1px solid var(--outline); border-radius:12px}
.chart-inner{min-height:300px; position:relative; padding-bottom:18px}
#chartAreas{display:block}

/* bottoni linee */
.areas-list{display:flex; gap:8px; flex-wrap:wrap; margin-top:10px}
.line-btn{border:1px solid var(--outline); background:var(--card); padding:6px 12px; border-radius:999px; cursor:pointer}
.line-btn.active{background:var(--brand); color:#fff; border-color:transparent}

/* late chips */
.late-list{display:flex; gap:8px; flex-wrap:wrap; margin-top:8px}
.late-chip{border:1px solid var(--outline); background:#fff6e6; color:#7a3b00; padding:6px 10px; border-radius:999px; cursor:pointer}
.late-chip .meta{opacity:.7; font-weight:700}

/* Area card */
.area-hd{display:flex; gap:10px; align-items:center; flex-wrap:wrap}
.area-line{font-weight:800; border:1px solid var(--outline); border-radius:10px; padding:8px 10px; width:140px; background:var(--card); color:var(--text)}
.area .tabs{margin-left:auto; display:flex; gap:8px}
.tab{border:1px solid var(--outline); background:var(--card); padding:6px 10px; border-radius:10px; cursor:pointer}
.tab.active{background:var(--brand); color:#fff; border-color:transparent}
.s-scores{display:flex; flex-wrap:wrap; gap:8px; margin:8px 0}
.s-tabs{display:flex; gap:8px; align-items:center; flex-wrap:wrap; margin-bottom:8px}
.panel{display:none}
.panel.active{display:block}

.area.collapsed .panel,
.area.collapsed .s-tabs,
.area.collapsed .s-scores{display:none}
.area.collapsed .collapse{background:var(--brand); color:#fff; border-color:transparent}

/* Item */
.item{display:grid; grid-template-columns:40px 1fr 200px 260px auto; gap:8px; align-items:center; padding:10px; border:1px dashed var(--outline); border-radius:12px; margin:8px 0; position:relative; background:var(--card)}
.item.late{box-shadow:0 0 0 2px rgba(229,75,75,.35) inset}
.desc{display:none; margin:6px 4px 12px; padding:10px; border-radius:10px; background:rgba(46,123,230,.08)}
.i-btn{width:36px; height:36px; border-radius:10px; border:1px solid var(--outline); background:var(--card); cursor:pointer}
.title input,.notes input,.who input{width:100%; padding:8px 10px; border:1px solid var(--outline); border-radius:10px; background:var(--card); color:var(--text)}

.points-dots{display:flex; gap:6px; justify-content:center}
.points-dots .dot{display:inline-grid; place-items:center; width:36px; height:36px; border-radius:999px; border:2px solid var(--outline); font-weight:800; cursor:pointer}
.points-dots .dot.active{background:var(--brand); color:#fff; border-color:transparent}

.item.highlight{outline:2px solid #ffb400; outline-offset:2px}
.item.flash{animation:flash .9s ease-out}
@keyframes flash{0%{box-shadow:0 0 0 8px rgba(255,180,0,.35)}100%{box-shadow:none}}

.foot{display:flex; justify-content:center; padding:30px; color:var(--muted)}

/* Responsive fix per item su schermi stretti */
@media (max-width: 1000px){
  .item{grid-template-columns:40px 1fr; grid-auto-rows:auto}
  .points-dots, .who, .notes, .del{grid-column:1 / -1}
}
